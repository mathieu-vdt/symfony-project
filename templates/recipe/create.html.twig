{% extends 'base.html.twig' %}
{% block title %}New Recipe{% endblock %}

{% block body %}
{{ form_start(form, { attr: {
  class: 'space-y-6',
  'data-turbo': 'false'
} }) }}

<section class="container mx-auto px-4 py-10">
  <header class="mb-8">
    <h1 class="text-3xl font-bold tracking-tight">
      <span class="bg-gradient-to-r from-indigo-600 via-violet-600 to-fuchsia-600 bg-clip-text text-transparent">
        Create Recipe
      </span>
    </h1>
    <p class="mt-2 text-sm text-zinc-600">Fill in the details below to create a new recipe.</p>
  </header>

  <div class="rounded-2xl border border-zinc-200/60 bg-white/80 shadow-sm p-6 max-w-3xl">

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
      <div>
        {{ form_label(form.title, 'Title', { label_attr: { class: 'block text-sm font-medium mb-1' } }) }}
        {{ form_widget(form.title, { attr: { class: 'w-full rounded-xl border border-zinc-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500' } }) }}
        {{ form_errors(form.title) }}
      </div>

      <div>
        {{ form_label(form.category, 'Category', { label_attr: { class: 'block text-sm font-medium mb-1' } }) }}
        {{ form_widget(form.category, { attr: { class: 'w-full rounded-xl border border-zinc-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white' } }) }}
        {{ form_errors(form.category) }}
      </div>
    </div>

    <div>
      {{ form_label(form.description, 'Description', { label_attr: { class: 'block text-sm font-medium mb-1' } }) }}
      {{ form_widget(form.description, { attr: { class: 'w-full rounded-xl border border-zinc-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500' } }) }}
      {{ form_errors(form.description) }}
    </div>

    <div>
      {{ form_label(form.instructions, 'Instructions', { label_attr: { class: 'block text-sm font-medium mb-1' } }) }}
      {{ form_widget(form.instructions, { attr: { class: 'w-full rounded-xl border border-zinc-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500' } }) }}
      {{ form_errors(form.instructions) }}
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
      <div>
        {{ form_label(form.prepTime, 'Preparation time (min)', { label_attr: { class: 'block text-sm font-medium mb-1' } }) }}
        {{ form_widget(form.prepTime, { attr: { class: 'w-full rounded-xl border border-zinc-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500' } }) }}
        {{ form_errors(form.prepTime) }}
      </div>

      <div>
        {{ form_label(form.difficulty, 'Difficulty', { label_attr: { class: 'block text-sm font-medium mb-2' } }) }}
        <div class="rating inline-flex gap-1">
          {% for child in form.difficulty|reverse %}
            <input
              type="radio"
              id="{{ child.vars.id }}"
              name="{{ child.vars.full_name }}"
              value="{{ child.vars.value }}">
            <label for="{{ child.vars.id }}" title="{{ child.vars.label }}">
              <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5">
                <path d="M12 17.27l-5.18 3.04 1.4-5.99L3 9.24l6.09-.52L12 3l2.91 5.72 6.09.52-5.22 5.08 1.4 5.99z"/>
              </svg>
            </label>
          {% endfor %}
        </div>
        <p class="mt-1 text-xs text-zinc-500">Click a star to choose 1 to 5.</p>
        {{ form_errors(form.difficulty) }}
      </div>
    </div>

    <div>
      {{ form_label(form.ingredients, 'Ingredients', { label_attr: { class: 'block text-sm font-medium mb-2' } }) }}
      <div class="flex flex-wrap gap-2">
        {% for child in form.ingredients %}
          <span class="relative">
            <input
              type="checkbox"
              id="{{ child.vars.id }}"
              name="{{ child.vars.full_name }}"
              value="{{ child.vars.value }}"
              class="sr-only peer"
            >
            <label for="{{ child.vars.id }}"
                   class="inline-flex items-center select-none cursor-pointer rounded-full border px-3 py-1 text-sm transition
                          border-zinc-300 text-zinc-700 bg-white hover:border-indigo-400
                          peer-checked:bg-indigo-600 peer-checked:text-white peer-checked:border-indigo-600">
              {{ child.vars.label }}
            </label>
          </span>
        {% endfor %}
      </div>
      {{ form_errors(form.ingredients) }}

      {% include 'recipe/_image_preview_field.html.twig' with { form: form } %}
    </div>

    <div class="flex items-center gap-3 pt-2">
      <button type="submit"
              class="inline-flex items-center rounded-xl bg-indigo-600 px-4 py-2 text-white font-medium hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
        Create
      </button>
      <a href="{{ path('app_home') }}" class="text-sm text-zinc-600 hover:text-zinc-800">Cancel</a>
    </div>

    {{ form_row(form._token) }}
  </div>
</section>

{{ form_end(form, { render_rest: false }) }}
{% endblock %}
